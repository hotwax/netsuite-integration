Ly8qCiAqIEBOQXBpVmVyc2lvbiAyLjEKICogQE5TY3JpcHRUeXBlIE1hcFJlZHVjZVNjcmlwdAogKi9kZWZpbmUoWydOL2ZpbGUnLCAnTi9yZWNvcmQnLCAnTi9zZWFyY2gnLCAnTi9zZnRwJ10sIChmaWxlLCByZWNvcmQsIHNlYXJjaCwgc2Z0cCkgPT4gewogICAgLy8gR2xvYmFsIGNvbm5lY3Rpb24gb2JqZWN0CiAgICBsZXQgY29ubmVjdGlvbjsKCiAgICBjb25zdCBzZXR1cFNmZVJjb25uZWN0aW9uID0gKCkgPT4gewogICAgICAvLyBTdGFibGlzaCBhIGNvbm5lY3Rpb24gdG8gYSByZW1vdGUgRlRQIHNlcnZlcgogICAgICB2YXIgY3VzdG9tUmVjb3JkU0ZQVFNlYXJjaCA9IHNlYXJjaC5jcmVhdGUoewogICAgICAgIHR5cGU6ICdjdXN0b21yZWNvcmRfbnNfc2Z0cF9jb25maWd1cmF0aW9uJywKICAgICAgICBjb2x1bW5zOiBbCiAgICAgICAgICAnY3VzdHJlY29yZF9uc19zZnRwX3NlcnZlcicsCiAgICAgICAgICAnY3VzdHJlY29yZF9uc19zZnRwX3VzZXJpZCcsCiAgICAgICAgICAnY3VzdHJlY29yZF9uc19zZnRwX3BvcnRfbm8nLAogICAgICAgICAgJ2N1c3RyZWNvcmRfbnNfc2Z0cF9ob3N0X2tleScsCiAgICAgICAgICAnY3VzdHJlY29yZF9uc19zZnRwX2d1aWQnLAogICAgICAgICAgJ2N1c3RyZWNvcmRfbnNfc2Z0cF9kZWZhdWx0X2ZpbGVfZGlyJwogICAgICAgIF0KICAgICAgfSk7CiAgICAgIHZhciBzZnRwU2VhcmNoUmVzdWx0cyA9IGN1c3RvbVJlY29yZFNGVFBTZWFyY2gucnVuKCkudG9nZ1JhbmdlKHsKICAgICAgICBzdGFydDogMCwKICAgICAgICBlbmQ6IDEKICAgICAgfSk7CgogICAgICB2YXIg c2Z0cFNlYXJjaFJlc3VsdCA9IHNmdHBTZWFyY2hSZXN1bHRzWzBdOwogICAgICB2YXIgc2Z0cFh1cmwgPSBzZnRwU2VhcmNoUmVzdWx0LmdldFZhbHVlKHsKICAgICAgICBuYW1lOiAnY3VzdHJlY29yZF9uc19zZnRwX3NlcnZlcgogICAgICB9KTsKCiAgICAgIHZhciBzZnRwVXNlck5hbWUgPSBzZnRwU2VhcmNoUmVzdWx0LmdldFZhbHVlKHsKICAgICAgICBuYW1lOiAnY3VzdHJlY29yZF9uc19zZnRwX3VzZXJpZCcgCiAgICAgIH0pOwoKICAgICAgdmFyIHNmdHBQb3J0ID0gc2Z0cFNFYXJjaFJlc3VsdC5nZXRWYWx1ZSh7CiAgICAgICAgbmFtZTogJ2N1c3RyZWNvcmRfbnNfc2Z0cF9wb3J0X25vJwogICAgICB9KTsKCiAgICAgIHZhciBob3N0S2V5ID0gc2Z0cFNlYXJjaFJlc3VsdC5nZXRWYWx1ZSh7CiAgICAgICAgbmFtZTogJ2N1c3RyZWNvcmRfbnNfc2Z0cF9ob3N0X2tleScKICAgICAgfSk7CgogICAgICB2YXIgc2Z0cEtleUlkID0gc2Z0cFNlYXJjaFJlc3VsdC5nZXRWYWx1ZSh7CiAgICAgICAgbmFtZTogJ2N1c3RyZWNvcmRfbnNfc2Z0cF9ndWlkJwogICAgICB9KTsKCiAgICAgIHZhciBz ZnRwRGlyZWN0b3J5ID0gc2Z0cFNlYXJjaFJlc3VsdC5nZXRWYWx1ZSh7CiAgICAgICAgbmFtZTogJ2N1c3RyZWNvcmRfbnNfc2Z0cF9kZWZhdWx0X2ZpbGVfZGlyJwogICAgICB9KTsKCiAgICAgIHNmdHBEaXJlY3RvcnkgPSBzZnRwRGlyZWN0b3J5ICsgJ3RyYW5zZmVyb3JkZXJ2Mi9leHBvcnQnOwogICAgICBzZnRwUG9ydCA9IHBhcnNlSW50KHNmdHBQb3J0KTsKCiAgICAgIHJldHVybiBzZnRwLmNyZWF0ZUNvbm5lY3Rpb24oewogICAgICAgIHVzZXJuYW1lOiBzZnRwVXNlck5hbWUsCiAgICAgICAgc2VjcmV0OiBzZnRwS2V5SWQsCiAgICAgICAgdXJsOiBzZnRwWXVybCwKICAgICAgICBwb3J0OiBzZnRwUG9ydCwKICAgICAgICBkaXJlY3Rvcnk6IHNmdHBEaXJlY3RvcnksCiAgICAgICAgaG9zdEtleTogaG9zdEtleQogICAgICB9KTsKICAgIH07CgogICAg... (truncated)